#!/usr/bin/python
#
# Created by Aaron Beckett January, 2016
#

import sys

from ctip_utils import CTIPError
import ctip_commands as ctip

helpText = """
./ctip <command> <args>
ctip run [-o <out_dir>] <config_table_name>
ctip run [-o <out_dir>] -f <config_file>

COMMANDS:

    run:

    gen:

    info:

    check:

config_table_name
    Name of the configuration table in the data base that stores
    the configuration to be run by this script.

-f, --config-file
    Name of a csv file with configurations to run. The configurations
    from this file will be used to fill a new sqlite table with the
    config table name.

-g, --generate
    If this option is present along with the -f option, the csv file is
    assumed to contain each possible value for each config option
    and the generated table of configurations will have all possible
    combinations of these options.

-o, --outdir
    Directory in which to place output files.
"""

def main(argv):
    try:
        command = argv[1]

        if command == "run":
            ctip.run(argv[2:])
        elif command == "gen":
            ctip.gen(argv[2:])
        elif command == "info":
            ctip.info(argv[2:])
        elif command == "check":
            ctip.check(argv[2:])
        else:
            raise RuntimeError

    except IndexError, RuntimeError:
        print helpText
        sys.exit(2)

    except CTIPError as e:
        print e.msg
        
if __name__ == "__main__":
    main(sys.argv)

